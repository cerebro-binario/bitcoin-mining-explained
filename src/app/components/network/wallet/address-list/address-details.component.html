<div class="min-h-screen bg-zinc-950 text-zinc-100">
  <div class="bg-zinc-900 border-b border-zinc-800 px-6 py-4">
    <div class="flex items-center justify-between mt-4">
      <h1 class="text-xl font-semibold text-zinc-200">Detalhes do Endereço</h1>
    </div>
  </div>

  <!-- Content -->
  <div class="container mx-auto px-6 py-8" *ngIf="addressData">
    <!-- Endereço -->
    <div class="mb-8">
      <div class="text-sm text-zinc-500 mb-2">Endereço</div>
      <div
        class="font-mono break-all flex items-center gap-3 p-4 bg-zinc-900 rounded-lg border border-zinc-700"
      >
        <div
          class="flex-1 bg-zinc-800/50 rounded p-2 font-mono text-sm break-all"
          [class.text-green-300]="addressData.bipFormat === 'bip44'"
          [class.text-blue-300]="addressData.bipFormat === 'bip49'"
          [class.text-purple-300]="addressData.bipFormat === 'bip84'"
        >
          {{ addressData.address }}
        </div>
        <div
          class="flex items-center gap-2 text-xs text-zinc-400"
          *ngIf="addressData.bipFormat"
        >
          <i
            class="pi pi-info-circle"
            [class.text-green-300]="addressData.bipFormat === 'bip44'"
            [class.text-blue-300]="addressData.bipFormat === 'bip49'"
            [class.text-purple-300]="addressData.bipFormat === 'bip84'"
          ></i>
          <span
            [class.text-green-300]="addressData.bipFormat === 'bip44'"
            [class.text-blue-300]="addressData.bipFormat === 'bip49'"
            [class.text-purple-300]="addressData.bipFormat === 'bip84'"
          >
            {{
              addressData.bipFormat === "bip44"
                ? "Legacy"
                : addressData.bipFormat === "bip49"
                ? "SegWit"
                : "Native SegWit"
            }}
          </span>
        </div>
        <button
          type="button"
          class="p-2 text-zinc-400 hover:text-blue-400 transition-colors"
          (click)="copyToClipboard(addressData.address)"
          title="Copiar endereço"
        >
          <i class="pi pi-copy"></i>
        </button>
      </div>
    </div>

    <!-- Chaves -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      <!-- Chave Privada -->
      <div class="bg-zinc-900 rounded-lg border border-zinc-700 p-6">
        <h3 class="text-lg font-semibold text-zinc-200 mb-4">Chave Privada</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm text-zinc-500 mb-2">Hex:</label>
            <div class="flex items-center gap-2">
              <input
                type="text"
                readonly
                [value]="'0x' + addressData.keys.priv.hex"
                class="flex-1 bg-zinc-800 text-green-300 font-mono text-sm rounded px-3 py-2 border border-zinc-600"
              />
              <button
                type="button"
                class="p-2 text-zinc-400 hover:text-blue-400 transition-colors"
                (click)="copyToClipboard('0x' + addressData.keys.priv.hex)"
                title="Copiar chave privada"
              >
                <i class="pi pi-copy"></i>
              </button>
            </div>
          </div>
          <div>
            <label class="block text-sm text-zinc-500 mb-2">Decimal:</label>
            <div class="flex items-center gap-2">
              <input
                type="text"
                readonly
                [value]="addressData.keys.priv.decimal"
                class="flex-1 bg-zinc-800 text-green-300 font-mono text-sm rounded px-3 py-2 border border-zinc-600"
              />
              <button
                type="button"
                class="p-2 text-zinc-400 hover:text-blue-400 transition-colors"
                (click)="copyToClipboard(addressData.keys.priv.decimal)"
                title="Copiar chave privada"
              >
                <i class="pi pi-copy"></i>
              </button>
            </div>
          </div>
          <div>
            <label class="block text-sm text-zinc-500 mb-2">WIF:</label>
            <div class="flex items-center gap-2">
              <input
                type="text"
                readonly
                [value]="addressData.keys.priv.wif"
                class="flex-1 bg-zinc-800 text-green-300 font-mono text-sm rounded px-3 py-2 border border-zinc-600"
              />
              <button
                type="button"
                class="p-2 text-zinc-400 hover:text-blue-400 transition-colors"
                (click)="copyToClipboard(addressData.keys.priv.wif)"
                title="Copiar chave privada"
              >
                <i class="pi pi-copy"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Chave Pública -->
      <div class="bg-zinc-900 rounded-lg border border-zinc-700 p-6">
        <h3 class="text-lg font-semibold text-zinc-200 mb-4">Chave Pública</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm text-zinc-500 mb-2">Hex:</label>
            <div class="flex items-center gap-2">
              <input
                type="text"
                readonly
                [value]="'0x' + addressData.keys.pub.hex"
                class="flex-1 bg-zinc-800 text-blue-300 font-mono text-sm rounded px-3 py-2 border border-zinc-600"
              />
              <button
                type="button"
                class="p-2 text-zinc-400 hover:text-blue-400 transition-colors"
                (click)="copyToClipboard('0x' + addressData.keys.pub.hex)"
                title="Copiar chave pública"
              >
                <i class="pi pi-copy"></i>
              </button>
            </div>
          </div>
          <div>
            <label class="block text-sm text-zinc-500 mb-2">Decimal:</label>
            <div class="flex items-center gap-2">
              <input
                type="text"
                readonly
                [value]="addressData.keys.pub.decimal"
                class="flex-1 bg-zinc-800 text-blue-300 font-mono text-sm rounded px-3 py-2 border border-zinc-600"
              />
              <button
                type="button"
                class="p-2 text-zinc-400 hover:text-blue-400 transition-colors"
                (click)="copyToClipboard(addressData.keys.pub.decimal)"
                title="Copiar chave pública"
              >
                <i class="pi pi-copy"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- UTXOs -->
    <div class="bg-zinc-900 rounded-lg border border-zinc-700 p-6">
      <h3 class="text-lg font-semibold text-zinc-200 mb-6">UTXOs</h3>

      <!-- UTXOs disponíveis (usando app-utxo) -->
      <div *ngIf="addressData.utxos.length > 0" class="mb-8">
        <h4 class="text-md font-semibold text-green-300 mb-4">
          UTXOs Disponíveis ({{ addressData.utxos.length }})
        </h4>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <app-utxo
            *ngFor="let utxo of addressData.utxos"
            [value]="utxo.output.value"
            [address]="utxo.output.scriptPubKey.address"
            [txid]="utxo.txId"
            [vout]="utxo.outputIndex"
            [isSpent]="false"
            [isWallet]="true"
            [isChange]="false"
            [showActions]="true"
          ></app-utxo>
        </div>
      </div>

      <!-- UTXOs gastos -->
      <div *ngIf="spentUtxos.length > 0">
        <h4 class="text-md font-semibold text-zinc-400 mb-4">
          UTXOs Gastos ({{ spentUtxos.length }})
        </h4>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div
            *ngFor="let utxo of spentUtxos"
            class="bg-gradient-to-br from-zinc-800/80 to-zinc-900/80 rounded-lg shadow-lg p-6 border-2 border-zinc-600 relative overflow-hidden opacity-80"
          >
            <!-- Marca d'água -->
            <div
              class="absolute inset-0 flex items-center justify-center opacity-5 pointer-events-none"
            >
              <i class="pi pi-bitcoin text-[200px] text-white"></i>
            </div>
            <!-- Elementos decorativos -->
            <div
              class="absolute top-0 left-0 w-16 h-16 border-t-2 border-l-2 border-zinc-600"
            ></div>
            <div
              class="absolute bottom-0 right-0 w-16 h-16 border-b-2 border-r-2 border-zinc-600"
            ></div>
            <!-- Ícone e valor principal -->
            <div
              class="flex items-center justify-center bg-gradient-to-br from-zinc-700 to-zinc-800 rounded-full w-16 h-16 shadow-lg relative"
            >
              <i class="pi pi-money-bill text-3xl text-zinc-400"></i>
            </div>
            <div class="flex-1 relative">
              <!-- Valor em destaque -->
              <div
                class="text-2xl font-bold text-zinc-400 flex items-center gap-2 mb-2"
              >
                {{ utxo.output.value / 100000000 | number : "1.8-8" }}
                <span class="text-base text-zinc-500">BTC</span>
              </div>
              <!-- Número de série (TxID) -->
              <div class="text-xs text-zinc-500 mt-3 font-mono tracking-wider">
                <span class="text-zinc-500">Nº de Série:</span>
                <span class="ml-2 break-all">{{ utxo.txId }}</span>
              </div>
              <!-- Out como referência -->
              <div class="text-xs text-zinc-500 mt-1 font-mono">
                <span class="text-zinc-500">Referência:</span>
                <span class="ml-2">{{ utxo.outputIndex }}</span>
              </div>
              <!-- Explicação didática -->
              <div
                class="text-xs text-zinc-500 mt-3 italic border-t border-zinc-700 pt-3"
              >
                <span class="font-semibold text-zinc-400">UTXO</span> = "Unspent
                Transaction Output"<br />
                Este UTXO já foi gasto em uma transação anterior. A assinatura
                foi usada para transferir o valor.
              </div>
              <!-- Campo de assinatura preenchido -->
              <div class="mt-4 border-t border-dashed border-zinc-700 pt-3">
                <div class="text-xs text-zinc-500 mb-1">
                  Assinatura do Proprietário
                </div>
                <div
                  class="h-12 bg-zinc-800/50 rounded border border-zinc-700 flex items-center justify-center"
                >
                  <div
                    class="text-green-400 font-mono text-sm flex items-center gap-2"
                  >
                    <i class="pi pi-check-circle text-green-400"></i>
                    Assinado e gasto em
                    {{ utxo.spentInTxId | slice : 0 : 8 }}...
                  </div>
                </div>
              </div>
            </div>
            <!-- Elemento decorativo direito -->
            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-20">
              <i class="pi pi-check-circle text-[100px] text-green-400"></i>
            </div>
          </div>
        </div>
      </div>

      <div
        *ngIf="addressData.utxos.length === 0 && spentUtxos.length === 0"
        class="text-zinc-500 italic text-center py-8"
      >
        Nenhum UTXO encontrado para este endereço.
      </div>
    </div>
  </div>

  <!-- Loading/Error state -->
  <div *ngIf="!addressData" class="container mx-auto px-6 py-8 text-center">
    <div class="text-zinc-500">
      <i class="pi pi-spin pi-spinner text-2xl mb-4"></i>
      <p>Carregando detalhes do endereço...</p>
    </div>
  </div>
</div>

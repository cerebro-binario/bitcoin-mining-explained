<div class="addresses-container">
  <div class="header">
    <h1>Endereços</h1>
    <p>Lista de endereços com saldos e UTXOs</p>
  </div>

  <p-table
    [value]="addresses"
    [loading]="loading"
    [paginator]="true"
    [rows]="10"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} endereços"
    [rowsPerPageOptions]="[10, 25, 50]"
    styleClass="p-datatable-striped"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Endereço</th>
        <th>Saldo</th>
        <th>UTXOs</th>
        <th>Ações</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-address>
      <tr>
        <td>
          <div class="address-cell">
            <span class="address-text">{{ address.address }}</span>
            <button
              pButton
              icon="pi pi-copy"
              class="p-button-rounded p-button-text"
              pTooltip="Copiar endereço"
              (click)="copyToClipboard(address.address)"
            ></button>
          </div>
        </td>
        <td>{{ formatBalance(address.balance) }}</td>
        <td>{{ address.utxos.length }}</td>
        <td>
          <button
            pButton
            icon="pi pi-list"
            class="p-button-rounded p-button-text"
            pTooltip="Ver UTXOs"
            (click)="showUtxos(address)"
          ></button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4">Nenhum endereço encontrado</td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog
    header="UTXOs do Endereço"
    [(visible)]="showUtxosDialog"
    [style]="{ width: '50vw' }"
    [modal]="true"
  >
    <div *ngIf="selectedAddress">
      <p-table [value]="selectedAddress.utxos">
        <ng-template pTemplate="header">
          <tr>
            <th>Tx ID</th>
            <th>Vout</th>
            <th>Valor</th>
            <th>Bloco</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-utxo>
          <tr>
            <td>{{ utxo.txid }}</td>
            <td>{{ utxo.vout }}</td>
            <td>{{ formatBalance(utxo.amount) }}</td>
            <td>{{ utxo.blockHeight }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </p-dialog>
</div>
